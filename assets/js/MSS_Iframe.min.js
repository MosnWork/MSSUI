var MSS_Iframe=function(){var a={menuDate:[],isTop:!1,icon:"icon-file"},b=0,c=function(c){var e;c&&"object"==typeof c&&$.extend(a,c),b=0,q(),f(),0==c.isTop&&$(".h-nav").remove(),p(),window.onresize=function(){p()},1==c.isTop?j():k(a.menuDate),void 0==r("mssNav")||""==r("mssNav")||"undefined"==r("mssNav")||"null"==r("mssNav")||null==r("mssNav")?void 0==r("mssopen")||""==r("mssopen")||"undefined"==r("mssopen")||"null"==r("mssopen")||null==r("mssopen")?(r("mssNav",null),r("mssopen","-1")):(e=r("mssopen").split(","),r("mssNav",null),d(e)):(e=r("mssNav").split(","),r("mssNav",null),d(e))},d=function(b){e(a.menuDate,b),void 0==r("mssopen")||""==r("mssopen")||"undefined"==r("mssopen")||"null"==r("mssopen")||null==r("mssopen")?h("-1"):h(r("mssopen"))},e=function(a,b){for(var c=0;c<a.length;c++)b.indexOf(a[c].id.toString())>=0&&m(a[c].id.toString(),a[c].text,a[c].href),e(a[c].nodes,b)},f=function(){$(".iframe-nav-box").delegate("dt","click mousedown",function(a){3==a.which?(a?a.stopPropagation():event.cancelBubble=!0,n($(this),a.pageX,a.pageY,$(this).attr("mss-id"))):h($(this).attr("mss-id"))}),$(document).on("click",function(a){$(a.target).parents(".iframe-nav-box").length>0||$(a.target).parents(".right-click-menu").length>0||$(".right-click-menu").remove()}),$(".h-nav-home").click(function(){h("-1")}),$(".iframe-nav-box").on("contextmenu",function(){return!1}),$(".iframe-nav-left").click(function(){b--,g()}),$(".iframe-nav-right").click(function(){b++,g()}),$(".iframe-nav-box").delegate(".icon-remove","click",function(a){var b,c,d,e,f;for(a?a.stopPropagation():event.cancelBubble=!0,b=$(this).parent().attr("mss-id"),$(this).parent().hasClass("current")&&($(this).parent().prev().click(),r("mssopen",$(this).parent().prev().attr("mss-id"))),c=$(".iframe-nav-box").find("dt"),d=0;d<c.length;d++)$(c[d]).attr("mss-id")==b&&$(c[d]).remove();for(e=$(".iframe-box").find("li"),d=0;d<e.length;d++)$(e[d]).attr("mss-id")==b&&$(e[d]).remove();for(f=r("mssNav").split(","),d=0;d<f.length;d++)f[d]==b&&f.splice(d,1);r("mssNav",f.join(","))})},g=function(){var a,c;0>b&&(b=0),b>$(".iframe-nav-box").find("dt").length&&(b=$(".iframe-nav-box").find("dt").length),a=i(b),c=i($(".iframe-nav-box").find("dt").length),a=a>c-($(".iframe-nav-box").width()-30)?c-($(".iframe-nav-box").width()-30):a,a=0>a?0:a,a=c<$(".iframe-nav-box").width()-30?0:a,$(".iframe-nav-box dl").stop().animate({left:-1*a+"px"},500),0==b&&$(".iframe-nav-box dl").stop().animate({left:"0px"},500)},h=function(a){var c,d,e,f,h,j;for(r("mssopen",a),c=0,d=$(".iframe-nav-box").find("dt"),e=0;e<d.length;e++)$(d[e]).attr("mss-id")==a&&(c=e,$(d[e]).addClass("current").siblings().removeClass("current"));for(f=$(".iframe-box").find("li"),e=0;e<f.length;e++)$(f[e]).attr("mss-id")==a&&$(f[e]).addClass("current").siblings().removeClass("current");if(h=Math.abs(parseInt($(".iframe-nav-box dl").css("left"))),j=i(c),h>j){for(e=0;9999>e&&(b--,!(i(b)<j));e++);b--}if(h+$(".iframe-nav-box").width()-30<j){for(e=0;9999>e&&(b++,!(i(b)+$(".iframe-nav-box").width()-30>=j));e++);b++}g()},i=function(a){var d,b=$(".iframe-nav-box").find("dt"),c=0;for(d=0;a>d;d++)c+=$(b[d]).outerWidth(!0);return c},j=function(){var c,d,e,b='<div class="h-nav-box"><ul>';for(c=0;c<a.menuDate.length;c++)b+="<li mss-key='"+a.menuDate[c].id+"'>"+a.menuDate[c].text+"</li>";b+="</ul></div>",d=$(b).appendTo(".h-nav"),e=10,d.find("li").each(function(){e+=$(this).outerWidth(!0)}),$(d.find("ul")[0]).css({width:e+"px"}),d.on("click","li",function(){$(this).addClass("current").siblings().removeClass("current"),k(a.menuDate.findObj("id",$(this).attr("mss-key")).nodes)}),$(d.find("li")[0]).click()},k=function(b){var d,e,c="<ul>";for(d=0;d<b.length;d++)c+="<li>",c+=""==b[d].href?'<p><i class="'+a.icon+'"></i>'+b[d].text+"</p>":'<p><i class="'+a.icon+'"></i><a mss-id="'+b[d].id+'" mss-href="'+b[d].href+'">'+b[d].text+"</a></p>",c+=l(b[d].nodes),c+="</li>";c+="</ul>",$(".mynav").empty(),e=$(c).appendTo(".mynav"),e.off(),e.on("click","p",function(){var a=$($(this).parent().find("ul")[0]);a.slideToggle("500")}),e.on("click","a",function(a){var b,c;for(a?a.stopPropagation():event.cancelBubble=!0,b=e.find("p"),c=0;c<b.length;c++)$(b[c]).removeClass("current");$(this).parent().addClass("current"),m($(this).attr("mss-id"),$(this).html(),$(this).attr("mss-href"))})},l=function(b){var c,d;if(b.length<1)return"";for(c="<ul class='list'>",d=0;d<b.length;d++)c+="<li>",c+=""==b[d].href?'<p><i class="'+a.icon+'"></i>'+b[d].text+"</p>":'<p><i class="'+a.icon+'"></i><a mss-id="'+b[d].id+'" mss-href="'+b[d].href+'">'+b[d].text+"</a></p>",c+=l(b[d].nodes),c+="</li>";return c+="</ul>"},m=function(a,b,c){var d,e,f,g,h;if(void 0==r("mssNav")||""==r("mssNav")||"undefined"==r("mssNav")||"null"==r("mssNav")||null==r("mssNav"))r("mssNav",a);else{if(r("mssNav").split(",").indexOf(a)>=0){for(d=$(".iframe-nav-box").find("dt"),e=0;e<d.length;e++)if($(d[e]).attr("mss-id")==a){$(d[e]).click();break}return!1}r("mssNav",r("mssNav")+","+a)}f='<dt mss-id="'+a+'">'+b+'<i class="icon-remove"></i></dt>',g=$(f).appendTo($(".iframe-nav").find("dl")),h='<li mss-id="'+a+'"><iframe width="100%" height="100%" frameborder="0" src="'+c+'"></iframe></li>',$(".iframe-box").append(h),g.click()},n=function(a,b,c,d){var e,f;$(".right-click-menu").remove(),e="<div class='right-click-menu' style='left:"+b+"px;top:"+c+"px;'><ul>",e+="<li data-handle='refresh'><i class='icon-refresh'></i>刷新当前页</li>",e+="<li data-handle='remove'><i class='icon-remove'></i>关闭当前页</li>",e+="<li data-handle='left'><i class='icon-remove-sign'></i>关闭左侧</li>",e+="<li data-handle='right'><i class='icon-remove-sign'></i>关闭右侧</li>",e+="</ul></div>",f=$(e).appendTo("body"),f.on("click","li",function(a){a?a.stopPropagation():event.cancelBubble=!0;var b=$(a.target).attr("data-handle");o(b,d)})},o=function(a,b){var e,f,g,c=$(".iframe-box").find("li"),d=$(".iframe-nav-box").find("dt");switch(a){case"refresh":for(e=0;e<c.length;e++)$(c[e]).attr("mss-id")==b&&$(c[e]).find("iframe")[0].contentWindow.location.reload(!0);break;case"remove":for(e=0;e<d.length;e++)$(d[e]).attr("mss-id")==b&&$(d[e]).find(".icon-remove").click();break;case"left":for(e=1;e<d.length&&$(d[e]).attr("mss-id")!=b;e++)$(d[e]).find(".icon-remove").click();for(f=$(".iframe-nav-box").find("dt"),e=1;e<f.length;e++)if($(f[e]).hasClass("current")){$(f[e]).click();break}break;case"right":for(g=!1,e=1;e<d.length;e++)1==g&&$(d[e]).find(".icon-remove").click(),$(d[e]).attr("mss-id")==b&&(g=!0)}$(".right-click-menu").remove()},p=function(){$(".main").css({height:$(window).height()-$(".header").height()-15+"px"}),$(".iframe-box").css({height:$(".myiframe").height()-30+"px"}),$(window).width()<480?($(".h-info").find("span").addClass("media"),$(".h-nav-user").addClass("h-nav-user-media"),$(".h-nav-box").addClass("h-nav-box-media")):($(".h-info").find("span").removeClass("media"),$(".h-nav-user").removeClass("h-nav-user-media"),$(".h-nav-box").removeClass("h-nav-box-media")),$(window).width()<640?($(".mynav").addClass("mynav-media"),$(".mywork").addClass("mywork-media"),$(".mywork").css({height:$(window).height()-$(".header").height()-25-$(".mynav").height()+"px"}),$(".myiframe").addClass("myiframe-media")):($(".mynav").removeClass("mynav-media"),$(".mywork").removeClass("mywork-media"),$(".mywork").css({height:"100%"}),$(".myiframe").removeClass("myiframe-media"))},q=function(){Array.prototype.findObj=function(a,b){var d,e,f,c=this;for(d=0;d<c.length;d++){e=c[d];for(f in e)if(f==a&&e[f]==b)return e}return{}}},r=function(a,b,c){var d,e,f,g,h,i,j,k,l;if("undefined"==typeof b){if(i=null,document.cookie&&""!=document.cookie)for(j=document.cookie.split(";"),k=0;k<j.length;k++)if(l=jQuery.trim(j[k]),l.substring(0,a.length+1)==a+"="){i=decodeURIComponent(l.substring(a.length+1));break}return i}c=c||{},null===b&&(b="",c.expires=-1),d="",c.expires&&("number"==typeof c.expires||c.expires.toUTCString)&&("number"==typeof c.expires?(e=new Date,e.setTime(e.getTime()+1e3*60*60*24*c.expires)):e=c.expires,d="; expires="+e.toUTCString()),f=c.path?"; path="+c.path:"",g=c.domain?"; domain="+c.domain:"",h=c.secure?"; secure":"",document.cookie=[a,"=",encodeURIComponent(b),d,f,g,h].join("")},s=function(a){var b,c,d;if(void 0==a.title||void 0==a.url||void 0==a.key)return console.log("什么玩意，参数补全"),!1;for(b=$(".iframe-nav-box").find("dt"),c=new Date,d=0;d<b.length;d++)$(b[d]).attr("mss-id")==a.key&&(console.log("什么玩意，参数重置"),a.key=a.key+c.getTime());m(a.key,a.title,a.url)},t=function(a){var c,b=$(".iframe-nav-box").find("dt");for(c=0;c<b.length;c++)$(b[c]).attr("mss-id")==a&&$(b[c]).find(".icon-remove").click()},u=function(a){var c,d,e,b={text:"",background:"#ff7e00",color:"#ffffff",location:"bottom,right",secs:3};switch(a&&"object"==typeof a&&$.extend(b,a),c="",b.location){case"top,left":c="top:5px;left:5px;";break;case"top,right":c="top:5px;right:5px;";break;case"bottom,left":c="bottom:5px;left:5px;";break;case"bottom,right":c="bottom:5px;right:5px;";break;default:c="bottom:5px;right:5px;"}d="<div style='"+c+"color:"+b.color+";background:"+b.background+";width:auto;overflow: hidden;box-sizing: border-box;max-width:50%;height:auto;padding:8px;position: absolute; z-index: 999999;border-radius: 3px;box-shadow: 0 1px 3px #cccccc;'>"+b.text+"</div>",e=$(d).appendTo("body"),e.click(function(){$(this).fadeOut(500,function(){$(this).remove()})}),setTimeout(function(){e.click()},1e3*parseInt(b.secs))};return{init:c,openIframe:s,closeIframe:t,sendMsg:u}}();